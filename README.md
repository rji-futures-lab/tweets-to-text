# Tweets-To-Text

TweetsToText is a bot that lives on Twitter. It collects your tweets into plain text files. So you can take your brilliant observations somewhere else.

[![Build Status](https://travis-ci.org/rji-futures-lab/tweets-to-text.svg?branch=master)](https://travis-ci.org/rji-futures-lab/tweets-to-text)
[![Coverage Status](https://coveralls.io/repos/github/rji-futures-lab/tweets-to-text/badge.svg?branch=master)](https://coveralls.io/github/rji-futures-lab/tweets-to-text?branch=master)

## Development notes

TweetsToText is built atop Twitter's [Account Activity API](https://developer.twitter.com/en/docs/accounts-and-users/subscribe-account-activity/overview), which allows the app to receive notifications about activity on Twitter (e.g., follows, direct messages and mentions) that is relative to specific account.

For example, whenever a user follows [TweetsToText](https://twitter.com/TweetsToText), Twitter sends a request to an endpoint of <tweetstotext.io>, where this web app is hosted. The web app processes that request and then sends a request to Twitter's API to create a new direct message, welcoming the user to the service.

When working on improvements and fixes to this web app, you often still need to interact with Twitter's API, but you also need to isolate ourselves from receiving or creating activity on the actual TweetsToText account.

In order to do that you have to:

1. Register a webhook with Twitter so that the platform will send requests to the web server running locally your machine
2. Subscribe to account activity for another Twitter account, called [T2Tproto](https://twitter.com/T2Tproto)

We can use [ngrok](https://ngrok.com/) to expose our localhost server to the public internet with HTTPS.

If you haven't already, [download](https://ngrok.com/download) and install ngrok.

Navigate into the tweets-to-text project directory, activate your virtual environment, and start the local server:

```sh
python manage.py runserver
```

Then open a separate terminal window (or tab), and start ngrok:

```sh
ngrok http 8000
```

Now we have a tunnel from the public internet to our local server. We can test this by copying the url in ngrok's output that looks like `https://{random characters}.ngrok.io`, and pasting this into web browser address bar. We should see the homepage for TweetsToText.

Finally, we have to register a webhook under the temporary domain generated by ngrok. At this point we need to open *yet another terminal window (or tab)* because we have to leave both the local web server and ngrok running.

Navigate into the tweets-to-text project directory, activate your virtual environment, and call this handy management command with the temporary ngrok domain:

```sh
python manage.py replacewebhook '{random characters}.ngrok.io'
```

This command will register the new webhook and subscribe to the prototype account.

And now you can start working on improvments to TweetsToText!
